<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit Report Software</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable@12.2.0/dist/handsontable.full.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            margin-top: 50px;
        }
        .ht_master .htCore td {
            white-space: normal !important;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4">Audit Report Preparation</h1>

        <ul class="nav nav-tabs mb-4" id="auditMenu" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="budget-tab" data-bs-toggle="tab" data-bs-target="#budget" type="button" role="tab" aria-controls="budget" aria-selected="true">Budget</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="voucher-audit-tab" data-bs-toggle="tab" data-bs-target="#voucher-audit" type="button" role="tab" aria-controls="voucher-audit" aria-selected="false">Voucher Audit</button>
            </li>
        </ul>

        <div class="tab-content" id="auditMenuContent">
            <div class="tab-pane fade show active" id="budget" role="tabpanel" aria-labelledby="budget-tab">
                <h3>Budget Section</h3>
                <div id="budgetTable" class="mb-3"></div>
                <button class="btn btn-primary me-2" onclick="addRowToTable('budgetTable')">Add Row</button>
                <button class="btn btn-danger me-2" onclick="deleteRowFromTable('budgetTable')">Delete Row</button>
                <button class="btn btn-primary me-2" onclick="addColumnToTable('budgetTable')">Add Column</button>
                <button class="btn btn-danger me-2" onclick="deleteColumnFromTable('budgetTable')">Delete Column</button>
                <button class="btn btn-success me-2" onclick="exportTableToExcel('budgetTable', 'budget.xlsx')">Export to Excel</button>
            </div>

            <div class="tab-pane fade" id="voucher-audit" role="tabpanel" aria-labelledby="voucher-audit-tab">
                <h3>Voucher Audit Section</h3>
                <div id="voucherAuditTable" class="mb-3"></div>
                <button class="btn btn-primary me-2" onclick="addRowToTable('voucherAuditTable')">Add Row</button>
                <button class="btn btn-danger me-2" onclick="deleteRowFromTable('voucherAuditTable')">Delete Row</button>
                <button class="btn btn-primary me-2" onclick="addColumnToTable('voucherAuditTable')">Add Column</button>
                <button class="btn btn-danger me-2" onclick="deleteColumnFromTable('voucherAuditTable')">Delete Column</button>
                <button class="btn btn-success me-2" onclick="exportTableToExcel('voucherAuditTable', 'voucher_audit.xlsx')">Export to Excel</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/handsontable@12.2.0/dist/handsontable.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Sample Data
        const budgetData = [
            ["Source", "Program", "Allocation", "Remarks"],
            ["Source 1", "Program 1", "1000", "Remark 1"],
            ["Source 2", "Program 2", "2000", "Remark 2"]
        ];

        const voucherAuditData = [
            ["Voucher No", "Source", "Amount", "Remarks"],
            ["V-001", "Source 1", "1000", "Remark 1"],
            ["V-002", "Source 2", "2000", "Remark 2"]
        ];

        // Initialize Tables
        const budgetTable = new Handsontable(document.getElementById('budgetTable'), {
            data: budgetData,
            colHeaders: true,
            rowHeaders: true,
            filters: true,
            dropdownMenu: true,
            manualColumnResize: true,
            manualRowResize: true,
            wordWrap: true,
            licenseKey: 'non-commercial-and-evaluation',
        });

        const voucherAuditTable = new Handsontable(document.getElementById('voucherAuditTable'), {
            data: voucherAuditData,
            colHeaders: true,
            rowHeaders: true,
            filters: true,
            dropdownMenu: true,
            manualColumnResize: true,
            manualRowResize: true,
            wordWrap: true,
            licenseKey: 'non-commercial-and-evaluation',
        });

        // Add Row to Table
        function addRowToTable(tableId) {
            const tableInstance = Handsontable.getInstance(document.getElementById(tableId));
            tableInstance.alter('insert_row', tableInstance.countRows());
        }

        // Delete Row from Table
        function deleteRowFromTable(tableId) {
            const tableInstance = Handsontable.getInstance(document.getElementById(tableId));
            const selected = tableInstance.getSelected();

            if (selected) {
                const startRow = selected[0][0];
                tableInstance.alter('remove_row', startRow);
            } else {
                alert('Please select a row to delete.');
            }
        }

        // Add Column to Table
        function addColumnToTable(tableId) {
            const tableInstance = Handsontable.getInstance(document.getElementById(tableId));
            tableInstance.alter('insert_col', tableInstance.countCols());
        }

        // Delete Column from Table
        function deleteColumnFromTable(tableId) {
            const tableInstance = Handsontable.getInstance(document.getElementById(tableId));
            const selected = tableInstance.getSelected();

            if (selected) {
                const startCol = selected[0][1];
                tableInstance.alter('remove_col', startCol);
            } else {
                alert('Please select a column to delete.');
            }
        }

        // Export Table to Excel
        function exportTableToExcel(tableId, filename) {
            const tableInstance = Handsontable.getInstance(document.getElementById(tableId));
            const data = tableInstance.getData();
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
            XLSX.writeFile(wb, filename);
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
